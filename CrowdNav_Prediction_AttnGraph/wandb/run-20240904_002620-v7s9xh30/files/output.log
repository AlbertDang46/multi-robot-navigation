Logging to /tmp/openai-2024-09-04-00-26-25-445774
Creating dummy env object to get spaces
Loaded the following checkpoint: trained_models/my_model/middle_fusion_2/checkpoints/00200.pt
/home/liyiping/anaconda3/envs/CrowdNav2/lib/python3.10/site-packages/gym/logger.py:30: UserWarning: [33mWARN: Box bound precision lowered by casting to float32
  warnings.warn(colorize('%s: %s'%('WARN', msg % args), 'yellow'))
/home/liyiping/dev/ogm_pred/ogm_sogmp_trans_pos_middle_fusion/CrowdNav_Prediction_AttnGraph/train.py:125: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  actor_critic.load_state_dict(torch.load(load_path),strict=False)
/home/liyiping/dev/ogm_pred/ogm_sogmp_trans_pos_middle_fusion/CrowdNav_Prediction_AttnGraph/rl/networks/ogm_rnn.py:942: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  robot_vel_pos_list=[torch.tensor(item) for item in self.robot_vel_pos_deque[robot_index]]
/home/liyiping/dev/ogm_pred/ogm_sogmp_trans_pos_middle_fusion/CrowdNav_Prediction_AttnGraph/rl/networks/ogm_rnn.py:943: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  lidar_list=[torch.tensor(item) for item in self.lidar_deque[robot_index]]
Predictor Training Loss: 1643.8060302734375 KL Loss: 419.03839111328125 CE Loss: 1639.6156412760417
Avg wmse 0.45776692032814026 Avg ssim 0.08412765711545944
Predictor Training Loss: 1455.664306640625 KL Loss: 416.43260701497394 CE Loss: 1451.5
Avg wmse 0.4414069950580597 Avg ssim 0.11690536886453629
Predictor Training Loss: 1345.6228434244792 KL Loss: 414.9434509277344 CE Loss: 1341.473388671875
Avg wmse 0.4251648485660553 Avg ssim 0.14759300649166107
Predictor Training Loss: 1366.3213704427083 KL Loss: 413.54563395182294 CE Loss: 1362.1859537760417
Avg wmse 0.4272562563419342 Avg ssim 0.14177997410297394
Predictor Training Loss: 1332.7348225911458 KL Loss: 414.99915568033856 CE Loss: 1328.5848388671875
Avg wmse 0.4214905798435211 Avg ssim 0.15330389142036438
Predictor Training Loss: 1263.9872233072917 KL Loss: 414.7223409016927 CE Loss: 1259.8400065104167
Avg wmse 0.4095240533351898 Avg ssim 0.17838037014007568
Predictor Training Loss: 1250.3863932291667 KL Loss: 414.1516927083333 CE Loss: 1246.244873046875
Avg wmse 0.4076305329799652 Avg ssim 0.18385575711727142
Predictor Training Loss: 1282.493408203125 KL Loss: 412.4009704589844 CE Loss: 1278.369384765625
Avg wmse 0.41349518299102783 Avg ssim 0.17280496656894684
Predictor Training Loss: 1215.4018147786458 KL Loss: 412.3848368326823 CE Loss: 1211.2779541015625
Avg wmse 0.396912544965744 Avg ssim 0.20390339195728302
Predictor Training Loss: 1153.644775390625 KL Loss: 412.7058919270833 CE Loss: 1149.5177408854167
Avg wmse 0.3823154866695404 Avg ssim 0.23323118686676025
/home/liyiping/dev/ogm_pred/ogm_sogmp_trans_pos_middle_fusion/CrowdNav_Prediction_AttnGraph/rl/networks/ogm_rnn.py:1033: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  robot_vel_pos_list=[torch.tensor(item) for item in self.robot_vel_pos_deque[robot_index]]
/home/liyiping/dev/ogm_pred/ogm_sogmp_trans_pos_middle_fusion/CrowdNav_Prediction_AttnGraph/rl/networks/ogm_rnn.py:1034: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  lidar_list=[torch.tensor(item) for item in self.lidar_deque[robot_index]]
Predictor Training Loss: 1262.3756917317708 KL Loss: 409.3405354817708 CE Loss: 1258.2823079427083
Avg wmse 0.4476403295993805 Avg ssim 0.11397287249565125
Predictor Training Loss: 1182.4451497395833 KL Loss: 413.9146321614583 CE Loss: 1178.3059895833333
Avg wmse 0.44123926758766174 Avg ssim 0.12989552319049835
Predictor Training Loss: 1108.8954671223958 KL Loss: 415.8075358072917 CE Loss: 1104.7373860677083
Avg wmse 0.4295078217983246 Avg ssim 0.15384064614772797
Predictor Training Loss: 1108.8358154296875 KL Loss: 419.2411295572917 CE Loss: 1104.6433919270833
Avg wmse 0.4286717474460602 Avg ssim 0.15598315000534058
Predictor Training Loss: 1074.7244059244792 KL Loss: 421.68019612630206 CE Loss: 1070.5076090494792
Avg wmse 0.4217606484889984 Avg ssim 0.1693194955587387
Predictor Training Loss: 1015.5537109375 KL Loss: 424.5420633951823 CE Loss: 1011.3082682291666
Avg wmse 0.4075551927089691 Avg ssim 0.19583971798419952
Predictor Training Loss: 989.5388590494791 KL Loss: 426.0955098470052 CE Loss: 985.2778930664062
Avg wmse 0.39825645089149475 Avg ssim 0.21365635097026825
Predictor Training Loss: 980.8146769205729 KL Loss: 425.4308369954427 CE Loss: 976.5603637695312
Avg wmse 0.39447057247161865 Avg ssim 0.223398819565773
Predictor Training Loss: 938.0800374348959 KL Loss: 426.30706787109375 CE Loss: 933.8169759114584
Avg wmse 0.3836326599121094 Avg ssim 0.2455952912569046
Predictor Training Loss: 906.2047729492188 KL Loss: 424.2848409016927 CE Loss: 901.9619140625
Avg wmse 0.37516191601753235 Avg ssim 0.26355621218681335
Predictor Training Loss: 1151.3487955729167 KL Loss: 347.2684020996094 CE Loss: 1147.8761393229167
Avg wmse 0.4314844608306885 Avg ssim 0.14341817796230316
Predictor Training Loss: 1054.896484375 KL Loss: 344.4234110514323 CE Loss: 1051.4522705078125
Avg wmse 0.4295203685760498 Avg ssim 0.15878702700138092
Predictor Training Loss: 980.1244303385416 KL Loss: 344.17954508463544 CE Loss: 976.6826375325521
Avg wmse 0.4269632399082184 Avg ssim 0.16946959495544434
Predictor Training Loss: 1006.5760701497396 KL Loss: 340.4388834635417 CE Loss: 1003.1716715494791
Avg wmse 0.4310356378555298 Avg ssim 0.1610959768295288
Predictor Training Loss: 988.7510579427084 KL Loss: 340.5910237630208 CE Loss: 985.3451538085938
Avg wmse 0.42560580372810364 Avg ssim 0.1692662239074707
Predictor Training Loss: 923.5835367838541 KL Loss: 338.90879313151044 CE Loss: 920.1944376627604
Avg wmse 0.410863995552063 Avg ssim 0.19520199298858643
Predictor Training Loss: 923.3897705078125 KL Loss: 340.60740152994794 CE Loss: 919.9836832682291
Avg wmse 0.40616369247436523 Avg ssim 0.2041415423154831
Predictor Training Loss: 955.6022135416666 KL Loss: 341.4756774902344 CE Loss: 952.1874593098959
Avg wmse 0.4111745357513428 Avg ssim 0.19676490128040314
Predictor Training Loss: 898.5946248372396 KL Loss: 341.11658732096356 CE Loss: 895.1834513346354
Avg wmse 0.4034803807735443 Avg ssim 0.21381908655166626
Predictor Training Loss: 855.1930135091146 KL Loss: 344.17205810546875 CE Loss: 851.7513020833334
Avg wmse 0.3977578580379486 Avg ssim 0.2271272987127304
Predictor Training Loss: 1617.3588053385417 KL Loss: 427.7976379394531 CE Loss: 1613.080810546875
Avg wmse 0.46638819575309753 Avg ssim 0.0773969441652298
Predictor Training Loss: 1455.5012613932292 KL Loss: 425.59336344401044 CE Loss: 1451.2453206380208
Avg wmse 0.4484773874282837 Avg ssim 0.11129913479089737
Predictor Training Loss: 1347.7815755208333 KL Loss: 424.9455871582031 CE Loss: 1343.5321044921875
Avg wmse 0.42621371150016785 Avg ssim 0.15126876533031464
Predictor Training Loss: 1348.7993977864583 KL Loss: 424.6473083496094 CE Loss: 1344.5528971354167
Avg wmse 0.42370471358299255 Avg ssim 0.15019099414348602
Predictor Training Loss: 1315.06884765625 KL Loss: 421.0886535644531 CE Loss: 1310.8579508463542
Avg wmse 0.42057323455810547 Avg ssim 0.15506084263324738
Predictor Training Loss: 1257.845703125 KL Loss: 420.15906778971356 CE Loss: 1253.6440836588542
Avg wmse 0.41470202803611755 Avg ssim 0.16921670734882355
Predictor Training Loss: 1234.0397135416667 KL Loss: 417.36329142252606 CE Loss: 1229.8660888671875
Avg wmse 0.41322770714759827 Avg ssim 0.1743038445711136
Predictor Training Loss: 1225.4462890625 KL Loss: 412.1780598958333 CE Loss: 1221.3245442708333
Avg wmse 0.4119444191455841 Avg ssim 0.17796485126018524
Predictor Training Loss: 1176.687255859375 KL Loss: 412.10548909505206 CE Loss: 1172.5662027994792
Avg wmse 0.40362706780433655 Avg ssim 0.19527427852153778
Predictor Training Loss: 1133.7135823567708 KL Loss: 413.8456319173177 CE Loss: 1129.5751546223958
Avg wmse 0.39484038949012756 Avg ssim 0.21330641210079193
Predictor Training Loss: 1437.5384114583333 KL Loss: 396.2335510253906 CE Loss: 1433.5760904947917
Avg wmse 0.4514964520931244 Avg ssim 0.10482249408960342
Predictor Training Loss: 1327.4065348307292 KL Loss: 389.9085286458333 CE Loss: 1323.5074462890625
Avg wmse 0.4438857138156891 Avg ssim 0.12183073908090591
Predictor Training Loss: 1218.739990234375 KL Loss: 391.26343790690106 CE Loss: 1214.8273518880208
Avg wmse 0.43394115567207336 Avg ssim 0.1429583728313446
Predictor Training Loss: 1164.1584879557292 KL Loss: 393.5328063964844 CE Loss: 1160.2231852213542
Avg wmse 0.42942988872528076 Avg ssim 0.15094144642353058
Predictor Training Loss: 1122.6290283203125 KL Loss: 394.40366617838544 CE Loss: 1118.6849772135417
Avg wmse 0.42254412174224854 Avg ssim 0.16359998285770416
Predictor Training Loss: 1076.0279134114583 KL Loss: 395.46410115559894 CE Loss: 1072.0732828776042
Avg wmse 0.4118310511112213 Avg ssim 0.18406975269317627
Predictor Training Loss: 1052.1030680338542 KL Loss: 396.2660624186198 CE Loss: 1048.1404215494792
Avg wmse 0.4059741795063019 Avg ssim 0.1972542554140091
Predictor Training Loss: 1057.4715576171875 KL Loss: 397.3413798014323 CE Loss: 1053.4981689453125
Avg wmse 0.40708884596824646 Avg ssim 0.19886906445026398
Predictor Training Loss: 1015.3218790690104 KL Loss: 398.96083577473956 CE Loss: 1011.332275390625
Avg wmse 0.3970803916454315 Avg ssim 0.22001028060913086
Predictor Training Loss: 975.0987345377604 KL Loss: 398.2853495279948 CE Loss: 971.1158650716146
Avg wmse 0.38476625084877014 Avg ssim 0.24450550973415375
Predictor Training Loss: 1200.7260335286458 KL Loss: 355.8825276692708 CE Loss: 1197.1671956380208
Avg wmse 0.44844505190849304 Avg ssim 0.11985504627227783
Predictor Training Loss: 1141.0206705729167 KL Loss: 357.9346110026042 CE Loss: 1137.4413248697917
Avg wmse 0.44259199500083923 Avg ssim 0.13394558429718018
Predictor Training Loss: 1066.6666259765625 KL Loss: 356.4996337890625 CE Loss: 1063.1016438802083
Avg wmse 0.43558990955352783 Avg ssim 0.15124310553073883
Predictor Training Loss: 1077.0976969401042 KL Loss: 356.76722208658856 CE Loss: 1073.530008951823
Avg wmse 0.44034114480018616 Avg ssim 0.14252038300037384
Predictor Training Loss: 1063.697021484375 KL Loss: 358.947998046875 CE Loss: 1060.1075439453125
Avg wmse 0.4389719069004059 Avg ssim 0.14602059125900269
Predictor Training Loss: 1006.2138468424479 KL Loss: 359.65907796223956 CE Loss: 1002.6172485351562
Avg wmse 0.42873987555503845 Avg ssim 0.16697756946086884
Predictor Training Loss: 969.5977172851562 KL Loss: 359.3688252766927 CE Loss: 966.0040283203125
Avg wmse 0.41789159178733826 Avg ssim 0.18844132125377655
Predictor Training Loss: 961.9992065429688 KL Loss: 356.6583251953125 CE Loss: 958.4326171875
Avg wmse 0.40882620215415955 Avg ssim 0.20563046634197235
Predictor Training Loss: 930.7416585286459 KL Loss: 358.55670166015625 CE Loss: 927.1561075846354
Avg wmse 0.3993845283985138 Avg ssim 0.22378404438495636
Predictor Training Loss: 895.412841796875 KL Loss: 358.499267578125 CE Loss: 891.8278401692709
Avg wmse 0.38952741026878357 Avg ssim 0.24371880292892456
Predictor Training Loss: 1079.9910888671875 KL Loss: 375.1127115885417 CE Loss: 1076.239990234375
Avg wmse 0.44109830260276794 Avg ssim 0.14185941219329834
Predictor Training Loss: 1033.988749186198 KL Loss: 373.32741292317706 CE Loss: 1030.2554728190105
Avg wmse 0.4337500333786011 Avg ssim 0.15603043138980865
Predictor Training Loss: 978.6713053385416 KL Loss: 375.5052490234375 CE Loss: 974.9162394205729
Avg wmse 0.4239678382873535 Avg ssim 0.17497612535953522
Predictor Training Loss: 983.6616007486979 KL Loss: 374.7460021972656 CE Loss: 979.9141438802084
Avg wmse 0.4275103807449341 Avg ssim 0.1682634800672531
Predictor Training Loss: 969.5796508789062 KL Loss: 375.74135335286456 CE Loss: 965.8222452799479
Avg wmse 0.4244368076324463 Avg ssim 0.1730578988790512
Predictor Training Loss: 921.909423828125 KL Loss: 377.9928385416667 CE Loss: 918.1294759114584
Avg wmse 0.4110192358493805 Avg ssim 0.1969379335641861
Predictor Training Loss: 894.9996337890625 KL Loss: 379.6641133626302 CE Loss: 891.2030029296875
Avg wmse 0.4011308252811432 Avg ssim 0.2159854918718338
Predictor Training Loss: 888.7415771484375 KL Loss: 382.0132242838542 CE Loss: 884.9214477539062
Avg wmse 0.3988751471042633 Avg ssim 0.22300375998020172
Predictor Training Loss: 855.08056640625 KL Loss: 380.7205098470052 CE Loss: 851.2733561197916
Avg wmse 0.39507022500038147 Avg ssim 0.23282085359096527
Predictor Training Loss: 821.9335123697916 KL Loss: 382.2911071777344 CE Loss: 818.1106160481771
Avg wmse 0.38925695419311523 Avg ssim 0.24608005583286285
Predictor Training Loss: 1190.0256754557292 KL Loss: 374.6018880208333 CE Loss: 1186.2796630859375
Avg wmse 0.4450770318508148 Avg ssim 0.1329428106546402
Predictor Training Loss: 1135.1548258463542 KL Loss: 371.9152119954427 CE Loss: 1131.4356689453125
Avg wmse 0.43898284435272217 Avg ssim 0.14561296999454498
Predictor Training Loss: 1070.204833984375 KL Loss: 372.40746053059894 CE Loss: 1066.4807535807292
Avg wmse 0.43047797679901123 Avg ssim 0.16220688819885254
Predictor Training Loss: 1064.3228759765625 KL Loss: 364.5741373697917 CE Loss: 1060.6771647135417
Avg wmse 0.4258084297180176 Avg ssim 0.16906315088272095
Predictor Training Loss: 1045.7115478515625 KL Loss: 364.0679423014323 CE Loss: 1042.0708821614583
Avg wmse 0.4225241243839264 Avg ssim 0.17447012662887573
Predictor Training Loss: 993.7275187174479 KL Loss: 361.41815185546875 CE Loss: 990.1133422851562
Avg wmse 0.4159623682498932 Avg ssim 0.18851685523986816
Predictor Training Loss: 966.4998779296875 KL Loss: 360.493896484375 CE Loss: 962.8949381510416
Avg wmse 0.41188493371009827 Avg ssim 0.19801048934459686
Predictor Training Loss: 965.7506713867188 KL Loss: 360.88376871744794 CE Loss: 962.1418253580729
Avg wmse 0.4144349992275238 Avg ssim 0.1949785202741623
Predictor Training Loss: 919.4747111002604 KL Loss: 363.3423156738281 CE Loss: 915.8412882486979
Avg wmse 0.4030357599258423 Avg ssim 0.2176600694656372
Predictor Training Loss: 875.8830973307291 KL Loss: 363.57945760091144 CE Loss: 872.247314453125
Avg wmse 0.3889276683330536 Avg ssim 0.24545550346374512
Predictor Training Loss: 1410.4876708984375 KL Loss: 377.25002034505206 CE Loss: 1406.7151692708333
Avg wmse 0.45991161465644836 Avg ssim 0.09467194229364395
Predictor Training Loss: 1322.984619140625 KL Loss: 379.1949055989583 CE Loss: 1319.1927083333333
Avg wmse 0.45232048630714417 Avg ssim 0.10906348377466202
Predictor Training Loss: 1227.0570475260417 KL Loss: 375.09564208984375 CE Loss: 1223.3060709635417
Avg wmse 0.44112610816955566 Avg ssim 0.13010483980178833
Predictor Training Loss: 1219.9088948567708 KL Loss: 379.9374186197917 CE Loss: 1216.1095377604167
Avg wmse 0.4376668930053711 Avg ssim 0.13691578805446625
Predictor Training Loss: 1184.8588460286458 KL Loss: 375.0802714029948 CE Loss: 1181.1080322265625
Avg wmse 0.4319479465484619 Avg ssim 0.14810006320476532
Predictor Training Loss: 1114.8761800130208 KL Loss: 377.2058614095052 CE Loss: 1111.1041259765625
Avg wmse 0.4211992025375366 Avg ssim 0.16976769268512726
Predictor Training Loss: 1101.1552734375 KL Loss: 378.3313903808594 CE Loss: 1097.3719889322917
Avg wmse 0.41606053709983826 Avg ssim 0.18086330592632294
Predictor Training Loss: 1142.0283203125 KL Loss: 381.1749267578125 CE Loss: 1138.2165934244792
Avg wmse 0.42136576771736145 Avg ssim 0.17300792038440704
Predictor Training Loss: 1084.7235514322917 KL Loss: 380.5978190104167 CE Loss: 1080.9175618489583
Avg wmse 0.4151293933391571 Avg ssim 0.1870301216840744
Predictor Training Loss: 1031.3403727213542 KL Loss: 378.57285563151044 CE Loss: 1027.5546468098958
Avg wmse 0.4039941728115082 Avg ssim 0.20965342223644257